import{d as W,j as h,w as ue,k as de,o as r,c as l,l as me,m as pe,n as D,a as n,p as O,q as ge,x as P,b as e,t as A,y as xe,r as se,z as ve,A as ne,B as fe,C as he,u as ye,D as be,E as _e,F as b,G as S,H as ke,g as _,e as F,f as we,I as Q,J as X,K as V,L as z,M as Y,N as j,O as Ce,P as Z,Q as Fe,R as B,s as ee,S as Re}from"./index-b1ef84b1.js";import{m as te}from"./marked.esm-be3d53b0.js";const De=W({__name:"CanvasThumb",props:{src:{default:""},size:{default:248}},setup(R){const o=R,m=h(null),k=()=>{const{src:p,size:c}=o;if(!p)return;const i=m.value;if(!i)return;const w=i.getContext("2d");if(!w)return;const d=new Image;d.onload=()=>{const{naturalHeight:x,naturalWidth:v}=d;v===x?(i.height=c,i.width=c):v>x?(i.height=c,i.width=c*(v/x)):v<x&&(i.width=c,i.height=c*(x/v)),w.drawImage(d,0,0,i.width,i.height)},d.decoding="async",d.src=p};return ue(()=>o.src,k),de(()=>k()),(p,c)=>(r(),l("canvas",{class:"aspect-square object-cover",ref_key:"canvasEl",ref:m},null,512))}}),Ee={class:"flex aspect-square overflow-hidden rounded bg-black/25"},Te=["textContent","title"],Ae=W({__name:"DirEntry",props:{entry:null},setup(R){const o=R,m=h(""),k=h(!1),p=h(!1),c=h(null);me(c,([{isIntersecting:u}])=>{k.value=u,u&&!p.value&&(p.value=!0,o.entry.type==="image"?i(o.entry.file):w())});const i=u=>{m.value=URL.createObjectURL(u)},w=async()=>{if(!o.entry.isDir)return;const u=await ve(o.entry.handle),f=ne(u,o.entry.displayName);if(f!=null&&f.isFile)return i(f.file);const y=fe(u);if(y!=null&&y.isFile)return i(y.file)};pe(()=>{m.value.startsWith("blob:")&&URL.revokeObjectURL(m.value)});const d=xe(),x=D(()=>{const{name:u}=o.entry.handle,{path:f}=d.params;return encodeURIComponent(f?decodeURIComponent(f)+"/"+u:u)}),v=he(),U=async()=>{if(o.entry.isDir){v.push({name:"Files",params:{path:x.value}});return}o.entry.isActive=!0},$=D(()=>{switch(o.entry.type){case"audio":return"Music1";case"dir":return"Folder";case"image":return"MediaImage";case"markdown":return"TextAlt";case"pdf":return"JournalPage";case"text":return"Page";case"unknown":return"EmptyPage";case"video":return"MediaVideo";default:return"EmptyPage"}});return(u,f)=>{const y=se("app-icon");return r(),l("button",{ref_key:"refWrap",ref:c,class:"group flex flex-col items-stretch gap-1 text-left",onClick:U},[n("div",Ee,[p.value&&m.value?O((r(),P(De,{key:0,src:m.value},null,8,["src"])),[[ge,k.value]]):(r(),P(y,{key:1,name:e($),size:"48",class:"mx-auto self-center text-gray-700"},null,8,["name"]))]),n("div",{class:"truncate rounded bg-gray-800 p-2 text-sm leading-none text-gray-500 group-hover:bg-gray-700/50",textContent:A(R.entry.displayName),title:R.entry.handle.name},null,8,Te)],512)}}}),Ue={class:"sticky top-0"},$e={class:"flex items-center justify-between bg-black/75 px-4 py-1 text-gray-400 backdrop-blur"},Ie={class:"flex flex-wrap items-center gap-4"},Le=["textContent"],Me=["textContent"],Se={class:"flex gap-2"},ze={key:0,class:"animate-spin"},je={key:0,class:"flex flex-wrap gap-2 bg-black/50 px-4 py-2 text-gray-400 backdrop-blur"},Ne=["onClick","onContextmenu","textContent"],Ve=["textContent"],Be={key:0,class:"grid grow place-content-center"},Oe={key:0,class:"space-y-4 text-center text-gray-600"},Pe=n("div",{class:"text-xl font-medium uppercase"},"No Results",-1),We={key:1,class:"space-y-2 text-center text-gray-600"},He=n("div",{class:"text-xl font-medium uppercase"},"Empty",-1),qe={key:0,class:"mx-auto w-full max-w-screen-2xl p-4"},Ge={class:"flex gap-4 rounded bg-gray-800 p-8 shadow-lg"},Je=["innerHTML"],Ke={key:0},Qe=["src","alt"],Xe={class:"mx-auto grid w-full max-w-screen-2xl grid-cols-5 gap-4 p-4"},Ye=["onSubmit"],Ze=n("h2",null,"README.md",-1),et=n("div",{class:"flex items-center justify-center gap-8"},[n("button",{class:"rounded bg-teal-600 px-4 py-1 hover:bg-teal-400 hover:text-teal-900",type:"submit"}," Save "),n("button",{type:"reset"},"Cancel")],-1),nt=W({__name:"Dir",setup(R){ye();const{showFilter:o,resetFilter:m,toggleFilter:k,filteredDirEntries:p,stringFilter:c,getTagsFromString:i,isTagFilterActive:w,isTagInFilter:d,removeTagsFromString:x,resetTagFilter:v,tagFilterOptions:U,toggleTag:$,isUntaggedActive:u,toggleUntagged:f}=be(S),y=h(),ae=async()=>{var s;k(),await Ce(),(s=y.value)==null||s.focus()},I=h(),L=h(""),H=h([]),M=new te.Renderer,re=M.link;M.link=(s,a,g)=>{const C=s==null?void 0:s.startsWith(`${location.protocol}//${location.hostname}`),t=re.call(M,s,a,g);return C?t:t.replace(/^<a /,'<a target="_blank" rel="noreferrer noopener nofollow" ')};const{trigger:le}=_e(b,async s=>{var t;if(!s){L.value="";return}I.value=await Z(s);const{content:a,frontmatter:g={}}=((t=I.value)==null?void 0:t.parsed)||{},{tags:C}=g;L.value=te.parse(a||"",{headerIds:!1,renderer:M}),H.value=Array.isArray(C)?C.filter(Boolean).map(N=>String(N)):[]},{immediate:!0}),q=D(()=>{var s;return x(((s=b.value)==null?void 0:s.name)||"")}),G=D(()=>{var s;return[...new Set([...H.value,...i(((s=b.value)==null?void 0:s.name)||"")].sort())]}),J=D(()=>{var s;return ne(S.value,x(((s=b.value)==null?void 0:s.name)||""))}),K=D(()=>{var s;return((s=J.value)==null?void 0:s.isFile)&&URL.createObjectURL(J.value.file)}),{textarea:oe,input:E}=ke(),T=h(!1),ie=async()=>{if(!b.value)return;const s=await Z(b.value);E.value=(s==null?void 0:s.content)||`---
tags: []
---
# ${q.value}`,T.value=!0},ce=async()=>{b.value&&(await Re(b.value,E.value,{name:"README.md",create:!0}),I.value||B(),le(),T.value=!1)};return(s,a)=>{var C;const g=se("app-icon");return r(),l(z,null,[n("header",Ue,[n("div",$e,[n("div",Ie,[n("span",{textContent:A(e(q))},null,8,Le),e(G).length?(r(),l("span",{key:0,class:"text-sm text-slate-600",textContent:A(e(G).join(", "))},null,8,Me)):_("",!0),n("button",{class:"flex items-center gap-1 text-sm text-slate-600",onClick:ie},[F(g,{name:I.value?"EditPencil":"AddCircle",size:"18"},null,8,["name"]),we(" README.md ")])]),n("div",Se,[e(Fe)?(r(),l("div",ze,[F(g,{class:"-scale-x-100",name:"AirplaneRotation"})])):_("",!0),e(o)?O((r(),l("input",{key:1,ref_key:"$stringFilter",ref:y,"onUpdate:modelValue":a[0]||(a[0]=t=>X(c)?c.value=t:null),class:"rounded-full border border-slate-600 bg-transparent px-4 outline-none placeholder:text-slate-700 focus:bg-slate-800 focus:placeholder:text-slate-400",type:"search",placeholder:"Filter listâ€¦"},null,512)),[[Q,e(c)]]):_("",!0),n("button",{onClick:ae,class:V(["p-1",{"text-amber-600":e(o)}])},[F(g,{name:"Filter"})],2),n("button",{class:"p-1",onClick:a[1]||(a[1]=(...t)=>e(B)&&e(B)(...t))},[F(g,{name:"Refresh"})]),n("button",{class:"p-1",onClick:a[2]||(a[2]=(...t)=>e(ee)&&e(ee)(...t))},[F(g,{name:"Folder"})])])]),e(o)&&e(U).length?(r(),l("div",je,[(r(!0),l(z,null,Y(e(U),t=>(r(),l("button",{key:t,class:V(["rounded-full px-2 text-sm",{"bg-amber-700 text-amber-100":e(d)(t,"include"),"bg-slate-900 text-slate-400 line-through":e(d)(t,"exclude"),"bg-slate-800 text-slate-400":!e(d)(t,"include")&&!e(d)(t,"exclude")}]),onClick:N=>e($)(t,"include"),onContextmenu:j(N=>e($)(t,"exclude"),["prevent"]),textContent:A(t)},null,42,Ne))),128)),n("button",{class:V(["rounded-full border px-2 text-sm",e(u)?"border-amber-700 text-amber-300":"border-slate-800 text-slate-600"]),onClick:a[3]||(a[3]=t=>e(f)()),textContent:A(e(w)?"+ Untagged":"Untagged")},null,10,Ve),e(w)||e(u)?(r(),l("button",{key:0,class:"text-sm text-slate-500",onClick:a[4]||(a[4]=(...t)=>e(v)&&e(v)(...t))}," clear ")):_("",!0)])):_("",!0)]),!e(S).length||!e(p).length?(r(),l("div",Be,[!e(p).length&&e(S).length?(r(),l("div",Oe,[F(g,{class:"mx-auto",name:"AreaSearch",size:"96"}),Pe,n("button",{class:"rounded-full border border-slate-600 px-4 py-1 font-medium",onClick:a[5]||(a[5]=(...t)=>e(m)&&e(m)(...t))}," Reset Filter ")])):(r(),l("div",We,[F(g,{class:"mx-auto",name:"GlassEmpty",size:"96"}),He]))])):(r(),l(z,{key:1},[L.value?(r(),l("div",qe,[n("div",Ge,[n("div",{class:"prose prose-sm prose-invert max-w-none flex-grow prose-headings:text-teal-100 prose-a:text-teal-600 prose-pre:bg-black prose-img:rounded",innerHTML:L.value},null,8,Je),e(K)?(r(),l("div",Ke,[n("img",{src:e(K),alt:(C=e(b))==null?void 0:C.name,class:"h-64 w-64 rounded object-cover shadow"},null,8,Qe)])):_("",!0)])])):_("",!0),n("div",Xe,[(r(!0),l(z,null,Y(e(p),t=>(r(),P(Ae,{key:t.handle.name,entry:t},null,8,["entry"]))),128))])],64)),T.value?(r(),l("form",{key:2,class:"fixed inset-0 grid place-items-center bg-black/50 backdrop-blur-lg",method:"post",onSubmit:j(ce,["prevent"]),onReset:a[8]||(a[8]=j(t=>T.value=!T.value,["prevent"]))},[n("div",{class:"flex max-h-full min-h-[60vh] w-full max-w-screen-lg flex-col gap-4 overflow-auto bg-slate-900 p-8 shadow-2xl",onClick:a[7]||(a[7]=j(()=>{},["stop"]))},[Ze,O(n("textarea",{class:"w-full grow resize-none rounded bg-black/50 p-4 font-mono focus:outline focus:outline-slate-600",ref_key:"$readmeTextarea",ref:oe,"onUpdate:modelValue":a[6]||(a[6]=t=>X(E)?E.value=t:null)},null,512),[[Q,e(E)]]),et])],40,Ye)):_("",!0)],64)}}});export{nt as default};
