import{m as F}from"./marked.esm.fa6ab4f4.js";import{d as L,r as x,w as I,o as M,j as i,k as h,U as T,g as W,u as $,c as w,a as O,h as j,q as l,p as P,v as z,l as E,i as p,B as V,t as b,y as C,F as R,V as A}from"./vendor.870a6cb0.js";import{a as q,g as B,b as H,u as N,c as D,e as S,s as U,f as k}from"./index.a4d47a2b.js";const G=L({props:{src:{default:""},size:{default:248}},setup(v){const n=v,s=x(null),d=()=>{const{src:m,size:a}=n;if(!m)return;const t=s.value;if(!t)return;const e=t.getContext("2d");if(!e)return;const o=new Image;o.onload=()=>{const{naturalHeight:r,naturalWidth:c}=o;c===r?(t.height=a,t.width=a):c>r?(t.height=a,t.width=a*(c/r)):c<r&&(t.width=a,t.height=a*(r/c)),e.drawImage(o,0,0,t.width,t.height)},o.decoding="async",o.src=m};return I(()=>n.src,d),M(()=>d()),(m,a)=>(i(),h("canvas",{class:"aspect-square object-cover",ref_key:"canvasEl",ref:s},null,512))}}),J={class:"flex aspect-square overflow-hidden rounded bg-black/25"},K=["textContent","title"],Q=L({props:{entry:null},setup(v){const n=v,s=x(""),d=x(!1),m=x(!1),a=x(null);T(a,([{isIntersecting:u}])=>{d.value=u,u&&!m.value&&(m.value=!0,n.entry.type==="image"?t(n.entry.file):e())});const t=u=>{s.value=URL.createObjectURL(u)},e=async()=>{if(!n.entry.isDir)return;const u=await q(n.entry.handle),g=B(u,n.entry.handle.name);if(g!=null&&g.isFile)return t(g.file);const _=H(u);if(_!=null&&_.isFile)return t(_.file)};W(()=>{s.value.startsWith("blob:")&&URL.revokeObjectURL(s.value)});const o=$(),r=w(()=>{const{name:u}=n.entry.handle,{path:g}=o.params;return encodeURIComponent(g?decodeURIComponent(g)+"/"+u:u)}),c=O(),f=async()=>{if(n.entry.isDir){c.push({name:"Files",params:{path:r.value}});return}n.entry.isActive=!0},y=w(()=>{switch(n.entry.type){case"audio":return"Music1";case"dir":return"Folder";case"image":return"MediaImage";case"markdown":return"TextAlt";case"pdf":return"JournalPage";case"text":return"Page";case"unknown":return"EmptyPage";case"video":return"MediaVideo";default:return"EmptyPage"}});return(u,g)=>{const _=j("app-icon");return i(),h("button",{ref_key:"refWrap",ref:a,class:"group flex flex-col items-stretch gap-1 text-left",onClick:f},[l("div",J,[m.value&&s.value?P((i(),E(G,{key:0,src:s.value},null,8,["src"])),[[z,d.value]]):(i(),E(_,{key:1,name:p(y),size:"48",class:"mx-auto self-center text-gray-700"},null,8,["name"]))]),l("div",{class:"truncate rounded bg-gray-800 p-2 text-sm leading-none text-gray-500 group-hover:bg-gray-700/50",textContent:V(v.entry.handle.name),title:v.entry.handle.name},null,8,K)],512)}}}),X={class:"sticky top-0 flex items-center justify-between bg-black/75 px-4 py-2 text-gray-400 backdrop-blur"},Y=["textContent"],Z={class:"flex gap-4"},ee={key:0,class:"animate-spin"},te={key:0,class:"grid grow place-content-center"},ne={class:"space-y-2 text-center text-gray-600"},se=l("div",{class:"text-xl uppercase"},"Empty",-1),ae={key:0,class:"mx-auto w-full max-w-screen-2xl p-4"},re={class:"flex gap-4 rounded bg-gray-800 p-8 shadow-lg"},oe=["innerHTML"],ce={key:0},le=["src","alt"],ie={class:"mx-auto grid w-full max-w-screen-2xl grid-cols-5 gap-4 p-4"},me=L({setup(v){N();const n=w(()=>k.value.find(e=>e.type==="markdown"&&e.file.name.toLowerCase()==="readme.md")),s=x(""),d=new F.Renderer,m=d.link;d.link=(e,o,r)=>{const c=e==null?void 0:e.startsWith(`${location.protocol}//${location.hostname}`),f=m.call(d,e,o,r);return c?f:f.replace(/^<a /,'<a target="_blank" rel="noreferrer noopener nofollow" ')},I(n,async e=>{if(!e||!e.isFile){s.value="";return}s.value=F.parse(await e.file.text(),{headerIds:!1,renderer:d})});const a=w(()=>{var e;return B(k.value,((e=D.value)==null?void 0:e.name)||"")}),t=w(()=>{var e;return((e=a.value)==null?void 0:e.isFile)&&URL.createObjectURL(a.value.file)});return(e,o)=>{var c,f;const r=j("app-icon");return i(),h(R,null,[l("header",X,[l("div",{textContent:V((c=p(D))==null?void 0:c.name)},null,8,Y),l("div",Z,[p(S)?(i(),h("div",ee,[b(r,{class:"-scale-x-100",name:"AirplaneRotation"})])):C("",!0),l("button",{onClick:o[0]||(o[0]=(...y)=>p(U)&&p(U)(...y))},[b(r,{name:"Folder"})])])]),p(k).length?(i(),h(R,{key:1},[s.value?(i(),h("div",ae,[l("div",re,[l("div",{class:"prose prose-sm prose-invert max-w-none flex-grow prose-headings:text-teal-100 prose-a:text-teal-600 prose-pre:bg-black prose-img:rounded",innerHTML:s.value},null,8,oe),p(t)?(i(),h("div",ce,[l("img",{src:p(t),alt:(f=p(D))==null?void 0:f.name,class:"h-64 w-64 rounded object-cover shadow"},null,8,le)])):C("",!0)])])):C("",!0),l("div",ie,[(i(!0),h(R,null,A(p(k),y=>(i(),E(Q,{key:y.handle.name,entry:y},null,8,["entry"]))),128))])],64)):(i(),h("div",te,[l("div",ne,[b(r,{class:"mx-auto",name:"GlassEmpty",size:"96"}),se])]))],64)}}});export{me as default};
