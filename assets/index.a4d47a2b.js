import{r as m,c as P,u as B,a as U,o as z,w as D,b as H,s as j,n as K,d as R,e as g,f as E,g as q,h as M,i as u,j as _,k,l as F,m as V,p as I,v as N,q as y,t as b,x as O,y as x,z as G,A as J,B as Q,C as Y,F as X,D as Z,E as ee,G as te,H as oe,I as re,J as ne,K as se,L as ie,M as ae,N as le,O as ue,P as ce,Q as de,R as fe,S as pe}from"./vendor.870a6cb0.js";const me=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}};me();const ve="modulepreload",$={},ge="/peekaboo/",f=function(o,e){return!e||e.length===0?o():Promise.all(e.map(t=>{if(t=`${ge}${t}`,t in $)return;$[t]=!0;const n=t.endsWith(".css"),a=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${a}`))return;const s=document.createElement("link");if(s.rel=n?"stylesheet":ve,n||(s.as="script",s.crossOrigin=""),s.href=t,document.head.appendChild(s),n)return new Promise((c,v)=>{s.addEventListener("load",c),s.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${t}`)))})})).then(()=>o())},h=m(),C=m(),Ie=async()=>{h.value=await window.showDirectoryPicker(),C.value=h.value},he=(r,o)=>r.startsWith("image/")?"image":r.startsWith("audio/")?"audio":r==="application/pdf"?"pdf":r.startsWith("video/")?"video":["text/markdown","text/x-markdown"].includes(r)||o.endsWith(".md")?"markdown":r.startsWith("text/")||r.endsWith("/json")||o.endsWith(".vue")?"text":"unknown",Ne=(r,o)=>{const e=j(o,{lower:!0}),t=r.find(n=>n.type==="image"&&n.file.name.toLowerCase().replace(/\.[^/.]+$/,"")===e);if(t)return t},Oe=r=>r.find(o=>o.type==="image"),A=m([]),_e=P(()=>A.value.filter(r=>r.isFile)),L=m(!1),we=async r=>{const o=[];if(r){for await(const[,e]of r.entries())if(!(e.name.startsWith(".")||["$RECYCLE.BIN","System Volume Information"].includes(e.name)))if(e.kind==="file"){const t=await e.getFile();if(!t.type&&!e.name.endsWith(".md")&&!e.name.endsWith(".vue"))continue;o.push({handle:e,file:t,type:he(t.type,e.name),mime:t.type,isActive:!1,isDir:!1,isFile:!0})}else o.push({handle:e,file:!1,type:"dir",isActive:!1,isDir:!0,isFile:!1})}return o.sort((e,t)=>e.isDir===t.isDir?e.handle.name.localeCompare(t.handle.name):e.isDir?-1:1),o},d=P(()=>A.value.find(r=>r.isActive)),p=r=>{const o=_e.value,e=o.findIndex(({isActive:t})=>t);e<0||(o[e].isActive=!1,e+r<0?o[o.length-e+r].isActive=!0:o.length>e+r?o[e+r].isActive=!0:o.length>r&&(o[r-1].isActive=!0))},$e=()=>{const r=B(),o=U();z(()=>{h.value||o.replace({name:"Home"})}),D(()=>h.value,()=>o.push({name:"Files"})),D(()=>C.value,async e=>{if(!e)return;L.value=!0;const t=await we(e);A.value=[],await K(),A.value=t,L.value=!1}),D(()=>r.params.path,async e=>{if(typeof e!="string"||!h.value)return;const t=decodeURIComponent(e).split("/").filter(Boolean);let n=h.value;for(const a of t)n=await n.getDirectoryHandle(decodeURIComponent(a));C.value=n}),H(()=>{L.value=!0})},ye=R({setup(r){const o={audio:g(()=>f(()=>import("./FileOverlayAudio.875c4fc4.js"),["assets/FileOverlayAudio.875c4fc4.js","assets/vendor.870a6cb0.js"])),image:g(()=>f(()=>import("./FileOverlayImage.f7dc3de9.js"),["assets/FileOverlayImage.f7dc3de9.js","assets/vendor.870a6cb0.js"])),markdown:g(()=>f(()=>import("./FileOverlayMarkdown.c6e1d7e7.js"),["assets/FileOverlayMarkdown.c6e1d7e7.js","assets/vendor.870a6cb0.js","assets/marked.esm.fa6ab4f4.js"])),pdf:g(()=>f(()=>import("./FileOverlayPdf.d738c58c.js"),["assets/FileOverlayPdf.d738c58c.js","assets/vendor.870a6cb0.js"])),text:g(()=>f(()=>import("./FileOverlayText.8f7f5486.js"),["assets/FileOverlayText.8f7f5486.js","assets/FileOverlayText.d4703037.css","assets/vendor.870a6cb0.js"])),unknown:g(()=>f(()=>import("./FileOverlayUnknown.2822e775.js"),[])),video:g(()=>f(()=>import("./FileOverlayVideo.89ec4a6b.js"),["assets/FileOverlayVideo.89ec4a6b.js","assets/vendor.870a6cb0.js"]))},e=()=>{!d.value||(d.value.isActive=!1)},t=m(!1),n=m(!1);let a=0;const s=()=>{n.value=!1},c=()=>{n.value=!0,clearTimeout(a),a=setTimeout(s,1e3)};E(["w","ArrowUp"],i=>{!d.value||(i.preventDefault(),p(-5))}),E(["d","ArrowRight"],i=>{!d.value||(i.preventDefault(),p(1))}),E(["s","ArrowDown"],i=>{!d.value||(i.preventDefault(),p(5))}),E(["a","ArrowLeft"],i=>{!d.value||(i.preventDefault(),p(-1))});const v=i=>{!d.value||(i.button===4&&(i.preventDefault(),p(1)),i.button===3&&(i.preventDefault(),p(-1)))};return document.addEventListener("mouseup",v),q(()=>{document.removeEventListener("mouseup",v)}),(i,l)=>{var S;const W=M("app-icon");return(S=u(d))!=null&&S.isFile?(_(),k("div",{key:0,class:"fixed inset-0 grid place-items-center bg-black/50 backdrop-blur-lg",onClick:e,onMousemove:c},[(_(),F(V(o[u(d).type]))),I(y("button",{class:"absolute right-0 top-1/2 -translate-y-1/2 overflow-hidden rounded-l-full bg-black/10 text-white/75 backdrop-blur-sm hover:bg-black/20",onClick:l[0]||(l[0]=O(w=>u(p)(1),["stop"])),onMouseenter:l[1]||(l[1]=w=>t.value=!0),onMouseleave:l[2]||(l[2]=w=>t.value=!1)},[b(W,{name:"NavArrowRight",size:"64",class:"drop-shadow"})],544),[[N,n.value||t.value]]),I(y("button",{class:"absolute left-0 top-1/2 -translate-y-1/2 overflow-hidden rounded-r-full bg-black/10 text-white/75 backdrop-blur-sm hover:bg-black/20",onClick:l[3]||(l[3]=O(w=>u(p)(-1),["stop"])),onMouseenter:l[4]||(l[4]=w=>t.value=!0),onMouseleave:l[5]||(l[5]=w=>t.value=!1)},[b(W,{name:"NavArrowLeft",size:"64",class:"drop-shadow"})],544),[[N,n.value||t.value]])],32)):x("",!0)}}});function be(r={}){const{immediate:o=!1,onNeedRefresh:e,onOfflineReady:t,onRegistered:n,onRegisterError:a}=r;let s,c;const v=async(i=!0)=>{i&&(s==null||s.addEventListener("controlling",l=>{l.isUpdate&&window.location.reload()})),c&&c.waiting&&await J(c.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){s=new G("/peekaboo/sw.js",{scope:"/peekaboo/",type:"classic"}),s.addEventListener("activated",i=>{i.isUpdate||t==null||t()});{const i=()=>{e==null||e()};s.addEventListener("waiting",i),s.addEventListener("externalwaiting",i)}s.register({immediate:o}).then(i=>{c=i,n==null||n(i)}).catch(i=>{a==null||a(i)})}return v}function Ee(r={}){const{immediate:o=!0,onNeedRefresh:e,onOfflineReady:t,onRegistered:n,onRegisterError:a}=r,s=m(!1),c=m(!1);return{updateServiceWorker:be({immediate:o,onNeedRefresh(){s.value=!0,e==null||e()},onOfflineReady(){c.value=!0,t==null||t()},onRegistered:n,onRegisterError:a}),offlineReady:c,needRefresh:s}}const T="Peekaboo",Te="1.0.0",ke={key:0,class:"fixed right-2 bottom-2 max-w-sm space-y-3 rounded-lg border border-gray-700 bg-gray-800 p-4 text-gray-400 shadow-lg",role:"alert"},Ae=["textContent"],Re={class:"flex gap-2"},De=R({setup(r){const{offlineReady:o,needRefresh:e,updateServiceWorker:t}=Ee(),n=async()=>{o.value=!1,e.value=!1};return(a,s)=>u(o)||u(e)?(_(),k("div",ke,[y("div",{class:"leading-tight",textContent:Q(u(o)?`${u(T)} is now offline available.`:`A new version of ${u(T)} is available.`)},null,8,Ae),y("div",Re,[u(e)?(_(),k("button",{key:0,class:"rounded bg-teal-700 px-2 py-1 font-medium text-teal-200 shadow",onClick:s[0]||(s[0]=c=>u(t)())}," Reload ")):x("",!0),y("button",{class:Y({"rounded px-2 py-1 font-medium text-teal-200":!0,"bg-teal-700 shadow":!u(e)}),onClick:n}," Close ",2)])])):x("",!0)}});const Le=R({setup(r){return(o,e)=>{const t=M("router-view");return _(),k(X,null,[b(t),b(ye),b(De)],64)}}});var xe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AirplaneRotation:Z,EmptyPage:ee,Folder:te,GlassEmpty:oe,JournalPage:re,MediaImage:ne,MediaVideo:se,Music1:ie,NavArrowRight:ae,NavArrowLeft:le,Page:ue,TextAlt:ce});const Ce=R({props:{name:null,size:{default:24}},setup(r){const o=r,e=P(()=>xe[o.name]);return(t,n)=>(_(),F(V(u(e)),{height:r.size,width:r.size},null,8,["height","width"]))}}),Pe=[{name:"Home",path:"/",component:()=>f(()=>import("./Home.b06cb828.js"),["assets/Home.b06cb828.js","assets/vendor.870a6cb0.js"])},{name:"Files",path:"/files/:path?",component:()=>f(()=>import("./Dir.6b83490c.js"),["assets/Dir.6b83490c.js","assets/marked.esm.fa6ab4f4.js","assets/vendor.870a6cb0.js"])}],We=de({history:fe("/peekaboo/"),routes:Pe,scrollBehavior(r,o,e){return e?(document.body.style.minHeight=e.top+window.innerHeight+"px",e):(document.body.style.removeProperty("min-height"),{top:0})}});pe(Le).component("AppIcon",Ce).use(We).mount("#app");export{we as a,Oe as b,C as c,T as d,L as e,A as f,Ne as g,d as h,Ie as s,$e as u,Te as v};
