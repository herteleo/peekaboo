import{r as m,c as P,u as U,a as z,o as H,w as L,b as j,s as K,n as q,d as D,e as g,f as E,g as G,h as M,i as u,j as _,k,l as F,m as V,p as I,v as N,q as y,t as b,x as O,y as x,z as J,A as Q,B as Y,C as X,F as Z,D as ee,E as te,G as re,H as oe,I as ne,J as se,K as ie,L as ae,M as le,N as ue,O as ce,P as de,Q as fe,R as pe,S as me,T as ve}from"./vendor.eb580b82.js";const ge=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}};ge();const he="modulepreload",T={},_e="/peekaboo/",f=function(t,e){return!e||e.length===0?t():Promise.all(e.map(o=>{if(o=`${_e}${o}`,o in T)return;T[o]=!0;const n=o.endsWith(".css"),a=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${a}`))return;const s=document.createElement("link");if(s.rel=n?"stylesheet":he,n||(s.as="script",s.crossOrigin=""),s.href=o,document.head.appendChild(s),n)return new Promise((c,v)=>{s.addEventListener("load",c),s.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())},h=m(),R=m(),Oe=async()=>{h.value=await window.showDirectoryPicker(),R.value=h.value},we=(r,t)=>r.startsWith("image/")?"image":r.startsWith("audio/")?"audio":r==="application/pdf"?"pdf":r.startsWith("video/")?"video":["text/markdown","text/x-markdown"].includes(r)||t.endsWith(".md")?"markdown":r.startsWith("text/")||r.endsWith("/json")||t.endsWith(".vue")?"text":"unknown",Te=(r,t)=>{const e=K(t,{lower:!0}),o=r.find(n=>n.type==="image"&&n.file.name.toLowerCase().replace(/\.[^/.]+$/,"")===e);if(o)return o},$e=r=>r.find(t=>t.type==="image"),A=m([]),ye=P(()=>A.value.filter(r=>r.isFile)),C=m(!1),be=async r=>{const t=[];if(r){for await(const[,e]of r.entries())if(!(e.name.startsWith(".")||["$RECYCLE.BIN","System Volume Information"].includes(e.name)))if(e.kind==="file"){const o=await e.getFile();if(!o.type&&!e.name.endsWith(".md")&&!e.name.endsWith(".vue"))continue;t.push({handle:e,file:o,type:we(o.type,e.name),mime:o.type,isActive:!1,isDir:!1,isFile:!0})}else t.push({handle:e,file:!1,type:"dir",isActive:!1,isDir:!0,isFile:!1})}return t.sort((e,o)=>e.isDir===o.isDir?e.handle.name.localeCompare(o.handle.name):e.isDir?-1:1),t},d=P(()=>A.value.find(r=>r.isActive)),p=r=>{const t=ye.value,e=t.findIndex(({isActive:o})=>o);e<0||(t[e].isActive=!1,e+r<0?t[t.length-e+r].isActive=!0:t.length>e+r?t[e+r].isActive=!0:t.length>r&&(t[r-1].isActive=!0))},B=async(r=R.value)=>{if(!r)return;C.value=!0;const t=await be(r);A.value=[],await q(),A.value=t,C.value=!1},Me=()=>{B()},Fe=()=>{const r=U(),t=z();H(()=>{h.value||t.replace({name:"Home"})}),L(()=>h.value,()=>t.push({name:"Files"})),L(()=>R.value,B),L(()=>r.params.path,async e=>{if(typeof e!="string"||!h.value)return;const o=decodeURIComponent(e).split("/").filter(Boolean);let n=h.value;for(const a of o)n=await n.getDirectoryHandle(decodeURIComponent(a));R.value=n}),j(()=>{C.value=!0})},Ee=D({setup(r){const t={audio:g(()=>f(()=>import("./FileOverlayAudio.27b3ac37.js"),["assets/FileOverlayAudio.27b3ac37.js","assets/vendor.eb580b82.js"])),image:g(()=>f(()=>import("./FileOverlayImage.4ee03014.js"),["assets/FileOverlayImage.4ee03014.js","assets/vendor.eb580b82.js"])),markdown:g(()=>f(()=>import("./FileOverlayMarkdown.560fee52.js"),["assets/FileOverlayMarkdown.560fee52.js","assets/vendor.eb580b82.js","assets/marked.esm.fa6ab4f4.js"])),pdf:g(()=>f(()=>import("./FileOverlayPdf.52278d19.js"),["assets/FileOverlayPdf.52278d19.js","assets/vendor.eb580b82.js"])),text:g(()=>f(()=>import("./FileOverlayText.21257264.js"),["assets/FileOverlayText.21257264.js","assets/FileOverlayText.d4703037.css","assets/vendor.eb580b82.js"])),unknown:g(()=>f(()=>import("./FileOverlayUnknown.2822e775.js"),[])),video:g(()=>f(()=>import("./FileOverlayVideo.eaf82ecf.js"),["assets/FileOverlayVideo.eaf82ecf.js","assets/vendor.eb580b82.js"]))},e=()=>{!d.value||(d.value.isActive=!1)},o=m(!1),n=m(!1);let a=0;const s=()=>{n.value=!1},c=()=>{n.value=!0,clearTimeout(a),a=setTimeout(s,1e3)};E(["w","ArrowUp"],i=>{!d.value||(i.preventDefault(),p(-5))}),E(["d","ArrowRight"],i=>{!d.value||(i.preventDefault(),p(1))}),E(["s","ArrowDown"],i=>{!d.value||(i.preventDefault(),p(5))}),E(["a","ArrowLeft"],i=>{!d.value||(i.preventDefault(),p(-1))});const v=i=>{!d.value||(i.button===4&&(i.preventDefault(),p(1)),i.button===3&&(i.preventDefault(),p(-1)))};return document.addEventListener("mouseup",v),G(()=>{document.removeEventListener("mouseup",v)}),(i,l)=>{var S;const W=M("app-icon");return(S=u(d))!=null&&S.isFile?(_(),k("div",{key:0,class:"fixed inset-0 grid place-items-center bg-black/50 backdrop-blur-lg",onClick:e,onMousemove:c},[(_(),F(V(t[u(d).type]))),I(y("button",{class:"absolute right-0 top-1/2 -translate-y-1/2 overflow-hidden rounded-l-full bg-black/10 text-white/75 backdrop-blur-sm hover:bg-black/20",onClick:l[0]||(l[0]=O(w=>u(p)(1),["stop"])),onMouseenter:l[1]||(l[1]=w=>o.value=!0),onMouseleave:l[2]||(l[2]=w=>o.value=!1)},[b(W,{name:"NavArrowRight",size:"64",class:"drop-shadow"})],544),[[N,n.value||o.value]]),I(y("button",{class:"absolute left-0 top-1/2 -translate-y-1/2 overflow-hidden rounded-r-full bg-black/10 text-white/75 backdrop-blur-sm hover:bg-black/20",onClick:l[3]||(l[3]=O(w=>u(p)(-1),["stop"])),onMouseenter:l[4]||(l[4]=w=>o.value=!0),onMouseleave:l[5]||(l[5]=w=>o.value=!1)},[b(W,{name:"NavArrowLeft",size:"64",class:"drop-shadow"})],544),[[N,n.value||o.value]])],32)):x("",!0)}}});function ke(r={}){const{immediate:t=!1,onNeedRefresh:e,onOfflineReady:o,onRegistered:n,onRegisterError:a}=r;let s,c;const v=async(i=!0)=>{i&&(s==null||s.addEventListener("controlling",l=>{l.isUpdate&&window.location.reload()})),c&&c.waiting&&await Q(c.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){s=new J("/peekaboo/sw.js",{scope:"/peekaboo/",type:"classic"}),s.addEventListener("activated",i=>{i.isUpdate||o==null||o()});{const i=()=>{e==null||e()};s.addEventListener("waiting",i),s.addEventListener("externalwaiting",i)}s.register({immediate:t}).then(i=>{c=i,n==null||n(i)}).catch(i=>{a==null||a(i)})}return v}function Re(r={}){const{immediate:t=!0,onNeedRefresh:e,onOfflineReady:o,onRegistered:n,onRegisterError:a}=r,s=m(!1),c=m(!1);return{updateServiceWorker:ke({immediate:t,onNeedRefresh(){s.value=!0,e==null||e()},onOfflineReady(){c.value=!0,o==null||o()},onRegistered:n,onRegisterError:a}),offlineReady:c,needRefresh:s}}const $="Peekaboo",Ve="1.1.0",Ae={key:0,class:"fixed right-2 bottom-2 max-w-sm space-y-3 rounded-lg border border-gray-700 bg-gray-800 p-4 text-gray-400 shadow-lg",role:"alert"},De=["textContent"],Le={class:"flex gap-2"},xe=D({setup(r){const{offlineReady:t,needRefresh:e,updateServiceWorker:o}=Re(),n=async()=>{t.value=!1,e.value=!1};return(a,s)=>u(t)||u(e)?(_(),k("div",Ae,[y("div",{class:"leading-tight",textContent:Y(u(t)?`${u($)} is now offline available.`:`A new version of ${u($)} is available.`)},null,8,De),y("div",Le,[u(e)?(_(),k("button",{key:0,class:"rounded bg-teal-700 px-2 py-1 font-medium text-teal-200 shadow",onClick:s[0]||(s[0]=c=>u(o)())}," Reload ")):x("",!0),y("button",{class:X({"rounded px-2 py-1 font-medium text-teal-200":!0,"bg-teal-700 shadow":!u(e)}),onClick:n}," Close ",2)])])):x("",!0)}});const Ce=D({setup(r){return(t,e)=>{const o=M("router-view");return _(),k(Z,null,[b(o),b(Ee),b(xe)],64)}}});var Pe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AirplaneRotation:ee,EmptyPage:te,Folder:re,GlassEmpty:oe,JournalPage:ne,MediaImage:se,MediaVideo:ie,Music1:ae,NavArrowRight:le,NavArrowLeft:ue,Page:ce,Refresh:de,TextAlt:fe});const We=D({props:{name:null,size:{default:24}},setup(r){const t=r,e=P(()=>Pe[t.name]);return(o,n)=>(_(),F(V(u(e)),{height:r.size,width:r.size},null,8,["height","width"]))}}),Se=[{name:"Home",path:"/",component:()=>f(()=>import("./Home.0b756efd.js"),["assets/Home.0b756efd.js","assets/vendor.eb580b82.js"])},{name:"Files",path:"/files/:path?",component:()=>f(()=>import("./Dir.4d7ef6a0.js"),["assets/Dir.4d7ef6a0.js","assets/marked.esm.fa6ab4f4.js","assets/vendor.eb580b82.js"])}],Ie=pe({history:me("/peekaboo/"),routes:Se,scrollBehavior(r,t,e){return e?(document.body.style.minHeight=e.top+window.innerHeight+"px",e):(document.body.style.removeProperty("min-height"),{top:0})}});ve(Ce).component("AppIcon",We).use(Ie).mount("#app");export{be as a,$e as b,R as c,$ as d,C as e,A as f,Te as g,d as h,Me as r,Oe as s,Fe as u,Ve as v};
