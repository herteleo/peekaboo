import{d as N,j as b,w as q,k as ee,o as n,c as l,l as te,m as se,n as E,a,p as G,q as ne,x as z,b as e,t as R,y as ae,z as J,A as re,B as oe,r as K,C as le,u as ie,D as ce,e as w,g as C,E as ue,F as de,G as A,H as M,I as S,J as pe,K as D,L as j,M as me,N as W,s as H,O as ge}from"./index.248ffe55.js";import{m as P}from"./marked.esm.2a07299f.js";const xe=N({__name:"CanvasThumb",props:{src:{default:""},size:{default:248}},setup(k){const r=k,p=b(null),y=()=>{const{src:m,size:i}=r;if(!m)return;const o=p.value;if(!o)return;const _=o.getContext("2d");if(!_)return;const d=new Image;d.onload=()=>{const{naturalHeight:g,naturalWidth:x}=d;x===g?(o.height=i,o.width=i):x>g?(o.height=i,o.width=i*(x/g)):x<g&&(o.width=i,o.height=i*(g/x)),_.drawImage(d,0,0,o.width,o.height)},d.decoding="async",d.src=m};return q(()=>r.src,y),ee(()=>y()),(m,i)=>(n(),l("canvas",{class:"aspect-square object-cover",ref_key:"canvasEl",ref:p},null,512))}}),fe={class:"flex aspect-square overflow-hidden rounded bg-black/25"},he=["textContent","title"],ve=N({__name:"DirEntry",props:{entry:null},setup(k){const r=k,p=b(""),y=b(!1),m=b(!1),i=b(null);te(i,([{isIntersecting:c}])=>{y.value=c,c&&!m.value&&(m.value=!0,r.entry.type==="image"?o(r.entry.file):_())});const o=c=>{p.value=URL.createObjectURL(c)},_=async()=>{if(!r.entry.isDir)return;const c=await ae(r.entry.handle),f=J(c,r.entry.displayName);if(f!=null&&f.isFile)return o(f.file);const h=re(c);if(h!=null&&h.isFile)return o(h.file)};se(()=>{p.value.startsWith("blob:")&&URL.revokeObjectURL(p.value)});const d=oe(),g=E(()=>{const{name:c}=r.entry.handle,{path:f}=d.params;return encodeURIComponent(f?decodeURIComponent(f)+"/"+c:c)}),x=le(),T=async()=>{if(r.entry.isDir){x.push({name:"Files",params:{path:g.value}});return}r.entry.isActive=!0},U=E(()=>{switch(r.entry.type){case"audio":return"Music1";case"dir":return"Folder";case"image":return"MediaImage";case"markdown":return"TextAlt";case"pdf":return"JournalPage";case"text":return"Page";case"unknown":return"EmptyPage";case"video":return"MediaVideo";default:return"EmptyPage"}});return(c,f)=>{const h=K("app-icon");return n(),l("button",{ref_key:"refWrap",ref:i,class:"group flex flex-col items-stretch gap-1 text-left",onClick:T},[a("div",fe,[m.value&&p.value?G((n(),z(xe,{key:0,src:p.value},null,8,["src"])),[[ne,y.value]]):(n(),z(h,{key:1,name:e(U),size:"48",class:"mx-auto self-center text-gray-700"},null,8,["name"]))]),a("div",{class:"truncate rounded bg-gray-800 p-2 text-sm leading-none text-gray-500 group-hover:bg-gray-700/50",textContent:R(k.entry.displayName),title:k.entry.handle.name},null,8,he)],512)}}}),ye={class:"sticky top-0"},_e={class:"flex items-center justify-between bg-black/75 px-4 py-1 text-gray-400 backdrop-blur"},be={class:"flex flex-wrap items-baseline gap-4"},ke=["textContent"],we=["textContent"],Ce={class:"flex gap-2"},Fe={key:0,class:"animate-spin"},De={key:0,class:"flex flex-wrap gap-2 bg-black/50 px-4 py-2 text-gray-400 backdrop-blur"},Re=["onClick","onContextmenu","textContent"],Ee=["textContent"],Te={key:0,class:"grid grow place-content-center"},Ue={key:0,class:"space-y-4 text-center text-gray-600"},Le=a("div",{class:"text-xl font-medium uppercase"},"No Results",-1),Ie={key:1,class:"space-y-2 text-center text-gray-600"},$e=a("div",{class:"text-xl font-medium uppercase"},"Empty",-1),Me={key:0,class:"mx-auto w-full max-w-screen-2xl p-4"},je={class:"flex gap-4 rounded bg-gray-800 p-8 shadow-lg"},Ae=["innerHTML"],ze={key:0},Ne=["src","alt"],Oe={class:"mx-auto grid w-full max-w-screen-2xl grid-cols-5 gap-4 p-4"},Se=N({__name:"Dir",setup(k){ie();const{showFilter:r,resetFilter:p,toggleFilter:y,filteredDirEntries:m,stringFilter:i,getTagsFromString:o,isTagFilterActive:_,isTagInFilter:d,removeTagsFromString:g,resetTagFilter:x,tagFilterOptions:T,toggleTag:U,isUntaggedActive:c,toggleUntagged:f}=ce(D),h=b(),Q=async()=>{var s;y(),await pe(),(s=h.value)==null||s.focus()},X=E(()=>D.value.find(s=>s.type==="markdown"&&s.file.name.toLowerCase()==="readme.md")),L=b(""),I=new P.Renderer,Y=I.link;I.link=(s,u,v)=>{const $=s==null?void 0:s.startsWith(`${location.protocol}//${location.hostname}`),F=Y.call(I,s,u,v);return $?F:F.replace(/^<a /,'<a target="_blank" rel="noreferrer noopener nofollow" ')},q(X,async s=>{if(!s||!s.isFile){L.value="";return}L.value=P.parse(await s.file.text(),{headerIds:!1,renderer:I})});const O=E(()=>{var s;return J(D.value,g(((s=j.value)==null?void 0:s.name)||""))}),V=E(()=>{var s;return((s=O.value)==null?void 0:s.isFile)&&URL.createObjectURL(O.value.file)});return(s,u)=>{var $,F,B;const v=K("app-icon");return n(),l(M,null,[a("header",ye,[a("div",_e,[a("div",be,[a("span",{textContent:R(e(g)((($=e(j))==null?void 0:$.name)||""))},null,8,ke),a("span",{class:"text-sm text-slate-600",textContent:R(e(o)(((F=e(j))==null?void 0:F.name)||"").join(", "))},null,8,we)]),a("div",Ce,[e(me)?(n(),l("div",Fe,[w(v,{class:"-scale-x-100",name:"AirplaneRotation"})])):C("",!0),e(r)?G((n(),l("input",{key:1,ref_key:"$stringFilter",ref:h,"onUpdate:modelValue":u[0]||(u[0]=t=>de(i)?i.value=t:null),class:"rounded-full border border-slate-600 bg-transparent px-4 outline-none placeholder:text-slate-700 focus:bg-slate-800 focus:placeholder:text-slate-400",type:"search",placeholder:"Filter list\u2026"},null,512)),[[ue,e(i)]]):C("",!0),a("button",{onClick:Q,class:A(["p-1",{"text-amber-600":e(r)}])},[w(v,{name:"Filter"})],2),a("button",{class:"p-1",onClick:u[1]||(u[1]=(...t)=>e(W)&&e(W)(...t))},[w(v,{name:"Refresh"})]),a("button",{class:"p-1",onClick:u[2]||(u[2]=(...t)=>e(H)&&e(H)(...t))},[w(v,{name:"Folder"})])])]),e(r)&&e(T).length?(n(),l("div",De,[(n(!0),l(M,null,S(e(T),t=>(n(),l("button",{key:t,class:A(["rounded-full px-2 text-sm",{"bg-amber-700 text-amber-100":e(d)(t,"include"),"bg-slate-900 text-slate-400 line-through":e(d)(t,"exclude"),"bg-slate-800 text-slate-400":!e(d)(t,"include")&&!e(d)(t,"exclude")}]),onClick:Z=>e(U)(t,"include"),onContextmenu:ge(Z=>e(U)(t,"exclude"),["prevent"]),textContent:R(t)},null,42,Re))),128)),a("button",{class:A(["rounded-full border px-2 text-sm",e(c)?"border-amber-700 text-amber-300":"border-slate-800 text-slate-600"]),onClick:u[3]||(u[3]=t=>e(f)()),textContent:R(e(_)?"+ Untagged":"Untagged")},null,10,Ee),e(_)||e(c)?(n(),l("button",{key:0,class:"text-sm text-slate-500",onClick:u[4]||(u[4]=(...t)=>e(x)&&e(x)(...t))}," clear ")):C("",!0)])):C("",!0)]),!e(D).length||!e(m).length?(n(),l("div",Te,[!e(m).length&&e(D).length?(n(),l("div",Ue,[w(v,{class:"mx-auto",name:"AreaSearch",size:"96"}),Le,a("button",{class:"rounded-full border border-slate-600 px-4 py-1 font-medium",onClick:u[5]||(u[5]=(...t)=>e(p)&&e(p)(...t))}," Reset Filter ")])):(n(),l("div",Ie,[w(v,{class:"mx-auto",name:"GlassEmpty",size:"96"}),$e]))])):(n(),l(M,{key:1},[L.value?(n(),l("div",Me,[a("div",je,[a("div",{class:"prose prose-sm prose-invert max-w-none flex-grow prose-headings:text-teal-100 prose-a:text-teal-600 prose-pre:bg-black prose-img:rounded",innerHTML:L.value},null,8,Ae),e(V)?(n(),l("div",ze,[a("img",{src:e(V),alt:(B=e(j))==null?void 0:B.name,class:"h-64 w-64 rounded object-cover shadow"},null,8,Ne)])):C("",!0)])])):C("",!0),a("div",Oe,[(n(!0),l(M,null,S(e(m),t=>(n(),z(ve,{key:t.handle.name,entry:t},null,8,["entry"]))),128))])],64))],64)}}});export{Se as default};
