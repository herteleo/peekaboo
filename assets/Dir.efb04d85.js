import{d as V,h as _,w as q,i as Z,o as s,c as l,j as ee,k as te,l as E,a as n,m as G,n as se,p as A,b as e,t as R,q as ne,x as J,y as ae,z as re,r as K,A as oe,u as le,B as ie,e as w,C,D as ce,E as ue,F as z,G as $,H as S,I as de,J as D,K as j,L as pe,M as W,s as H}from"./index.44b741f6.js";import{m as P}from"./marked.esm.2a07299f.js";const me=V({__name:"CanvasThumb",props:{src:{default:""},size:{default:248}},setup(b){const r=b,d=_(null),v=()=>{const{src:p,size:i}=r;if(!p)return;const o=d.value;if(!o)return;const k=o.getContext("2d");if(!k)return;const m=new Image;m.onload=()=>{const{naturalHeight:g,naturalWidth:x}=m;x===g?(o.height=i,o.width=i):x>g?(o.height=i,o.width=i*(x/g)):x<g&&(o.width=i,o.height=i*(g/x)),k.drawImage(m,0,0,o.width,o.height)},m.decoding="async",m.src=p};return q(()=>r.src,v),Z(()=>v()),(p,i)=>(s(),l("canvas",{class:"aspect-square object-cover",ref_key:"canvasEl",ref:d},null,512))}}),ge={class:"flex aspect-square overflow-hidden rounded bg-black/25"},xe=["textContent","title"],fe=V({__name:"DirEntry",props:{entry:null},setup(b){const r=b,d=_(""),v=_(!1),p=_(!1),i=_(null);ee(i,([{isIntersecting:c}])=>{v.value=c,c&&!p.value&&(p.value=!0,r.entry.type==="image"?o(r.entry.file):k())});const o=c=>{d.value=URL.createObjectURL(c)},k=async()=>{if(!r.entry.isDir)return;const c=await ne(r.entry.handle),f=J(c,r.entry.displayName);if(f!=null&&f.isFile)return o(f.file);const h=ae(c);if(h!=null&&h.isFile)return o(h.file)};te(()=>{d.value.startsWith("blob:")&&URL.revokeObjectURL(d.value)});const m=re(),g=E(()=>{const{name:c}=r.entry.handle,{path:f}=m.params;return encodeURIComponent(f?decodeURIComponent(f)+"/"+c:c)}),x=oe(),T=async()=>{if(r.entry.isDir){x.push({name:"Files",params:{path:g.value}});return}r.entry.isActive=!0},M=E(()=>{switch(r.entry.type){case"audio":return"Music1";case"dir":return"Folder";case"image":return"MediaImage";case"markdown":return"TextAlt";case"pdf":return"JournalPage";case"text":return"Page";case"unknown":return"EmptyPage";case"video":return"MediaVideo";default:return"EmptyPage"}});return(c,f)=>{const h=K("app-icon");return s(),l("button",{ref_key:"refWrap",ref:i,class:"group flex flex-col items-stretch gap-1 text-left",onClick:T},[n("div",ge,[p.value&&d.value?G((s(),A(me,{key:0,src:d.value},null,8,["src"])),[[se,v.value]]):(s(),A(h,{key:1,name:e(M),size:"48",class:"mx-auto self-center text-gray-700"},null,8,["name"]))]),n("div",{class:"truncate rounded bg-gray-800 p-2 text-sm leading-none text-gray-500 group-hover:bg-gray-700/50",textContent:R(b.entry.displayName),title:b.entry.handle.name},null,8,xe)],512)}}}),he={class:"sticky top-0"},ye={class:"flex items-center justify-between bg-black/75 px-4 py-1 text-gray-400 backdrop-blur"},ve={class:"flex flex-wrap items-baseline gap-4"},_e=["textContent"],be=["textContent"],ke={class:"flex gap-2"},we={key:0,class:"animate-spin"},Ce={key:0,class:"flex flex-wrap gap-2 bg-black/50 px-4 py-2 text-gray-400 backdrop-blur"},Fe=["onClick","textContent"],De=["textContent"],Re={key:0,class:"grid grow place-content-center"},Ee={key:0,class:"space-y-4 text-center text-gray-600"},Te=n("div",{class:"text-xl font-medium uppercase"},"No Results",-1),Ue={key:1,class:"space-y-2 text-center text-gray-600"},Le=n("div",{class:"text-xl font-medium uppercase"},"Empty",-1),Ie={key:0,class:"mx-auto w-full max-w-screen-2xl p-4"},$e={class:"flex gap-4 rounded bg-gray-800 p-8 shadow-lg"},je=["innerHTML"],Me={key:0},ze=["src","alt"],Ae={class:"mx-auto grid w-full max-w-screen-2xl grid-cols-5 gap-4 p-4"},Oe=V({__name:"Dir",setup(b){le();const{showFilter:r,resetFilter:d,toggleFilter:v,filteredDirEntries:p,stringFilter:i,getTagsFromString:o,isTagInFilter:k,removeTagsFromString:m,resetTagFilter:g,tagFilter:x,tagFilterOptions:T,toggleTag:M,isUntaggedActive:c,toggleUntagged:f}=ie(D),h=_(),Q=async()=>{var t;v(),await de(),(t=h.value)==null||t.focus()},X=E(()=>D.value.find(t=>t.type==="markdown"&&t.file.name.toLowerCase()==="readme.md")),U=_(""),L=new P.Renderer,Y=L.link;L.link=(t,u,y)=>{const I=t==null?void 0:t.startsWith(`${location.protocol}//${location.hostname}`),F=Y.call(L,t,u,y);return I?F:F.replace(/^<a /,'<a target="_blank" rel="noreferrer noopener nofollow" ')},q(X,async t=>{if(!t||!t.isFile){U.value="";return}U.value=P.parse(await t.file.text(),{headerIds:!1,renderer:L})});const B=E(()=>{var t;return J(D.value,m(((t=j.value)==null?void 0:t.name)||""))}),N=E(()=>{var t;return((t=B.value)==null?void 0:t.isFile)&&URL.createObjectURL(B.value.file)});return(t,u)=>{var I,F,O;const y=K("app-icon");return s(),l($,null,[n("header",he,[n("div",ye,[n("div",ve,[n("span",{textContent:R(e(m)(((I=e(j))==null?void 0:I.name)||""))},null,8,_e),n("span",{class:"text-sm text-slate-600",textContent:R(e(o)(((F=e(j))==null?void 0:F.name)||"").join(", "))},null,8,be)]),n("div",ke,[e(pe)?(s(),l("div",we,[w(y,{class:"-scale-x-100",name:"AirplaneRotation"})])):C("",!0),e(r)?G((s(),l("input",{key:1,ref_key:"$stringFilter",ref:h,"onUpdate:modelValue":u[0]||(u[0]=a=>ue(i)?i.value=a:null),class:"rounded-full border border-slate-600 bg-transparent px-4 outline-none placeholder:text-slate-700 focus:bg-slate-800 focus:placeholder:text-slate-400",type:"search",placeholder:"Filter list\u2026"},null,512)),[[ce,e(i)]]):C("",!0),n("button",{onClick:Q,class:z(["p-1",{"text-amber-600":e(r)}])},[w(y,{name:"Filter"})],2),n("button",{class:"p-1",onClick:u[1]||(u[1]=(...a)=>e(W)&&e(W)(...a))},[w(y,{name:"Refresh"})]),n("button",{class:"p-1",onClick:u[2]||(u[2]=(...a)=>e(H)&&e(H)(...a))},[w(y,{name:"Folder"})])])]),e(r)&&e(T).length?(s(),l("div",Ce,[(s(!0),l($,null,S(e(T),a=>(s(),l("button",{key:a,class:z(["rounded-full px-2 text-sm",e(k)(a)?"bg-amber-700 text-amber-100":"bg-slate-800 text-slate-400"]),onClick:Ve=>e(M)(a),textContent:R(a)},null,10,Fe))),128)),n("button",{class:z(["rounded-full border px-2 text-sm",e(c)?"border-amber-700 text-amber-300":"border-slate-800 text-slate-600"]),onClick:u[3]||(u[3]=a=>e(f)()),textContent:R(e(x).length?"+ Untagged":"Untagged")},null,10,De),e(x).length||e(c)?(s(),l("button",{key:0,class:"text-sm text-slate-500",onClick:u[4]||(u[4]=(...a)=>e(g)&&e(g)(...a))}," clear ")):C("",!0)])):C("",!0)]),!e(D).length||!e(p).length?(s(),l("div",Re,[!e(p).length&&e(D).length?(s(),l("div",Ee,[w(y,{class:"mx-auto",name:"AreaSearch",size:"96"}),Te,n("button",{class:"rounded-full border border-slate-600 px-4 py-1 font-medium",onClick:u[5]||(u[5]=(...a)=>e(d)&&e(d)(...a))}," Reset Filter ")])):(s(),l("div",Ue,[w(y,{class:"mx-auto",name:"GlassEmpty",size:"96"}),Le]))])):(s(),l($,{key:1},[U.value?(s(),l("div",Ie,[n("div",$e,[n("div",{class:"prose prose-sm prose-invert max-w-none flex-grow prose-headings:text-teal-100 prose-a:text-teal-600 prose-pre:bg-black prose-img:rounded",innerHTML:U.value},null,8,je),e(N)?(s(),l("div",Me,[n("img",{src:e(N),alt:(O=e(j))==null?void 0:O.name,class:"h-64 w-64 rounded object-cover shadow"},null,8,ze)])):C("",!0)])])):C("",!0),n("div",Ae,[(s(!0),l($,null,S(e(p),a=>(s(),A(fe,{key:a.handle.name,entry:a},null,8,["entry"]))),128))])],64))],64)}}});export{Oe as default};
