import{d as z,j as y,w as q,k as ee,o as n,c as i,l as te,m as se,n as E,a,p as G,q as ne,x as S,b as e,t as T,y as ae,z as J,A as re,B as oe,r as K,C as le,u as ie,D as ce,E as R,F as A,e as C,g as F,G as ue,H as de,I as j,J as M,K as B,L as pe,M as me,N as P,s as W,O as ge,P as xe}from"./index-3e1b3bae.js";import{m as H}from"./marked.esm-be3d53b0.js";const fe=z({__name:"CanvasThumb",props:{src:{default:""},size:{default:248}},setup(k){const r=k,p=y(null),_=()=>{const{src:m,size:c}=r;if(!m)return;const o=p.value;if(!o)return;const b=o.getContext("2d");if(!b)return;const d=new Image;d.onload=()=>{const{naturalHeight:x,naturalWidth:f}=d;f===x?(o.height=c,o.width=c):f>x?(o.height=c,o.width=c*(f/x)):f<x&&(o.width=c,o.height=c*(x/f)),b.drawImage(d,0,0,o.width,o.height)},d.decoding="async",d.src=m};return q(()=>r.src,_),ee(()=>_()),(m,c)=>(n(),i("canvas",{class:"aspect-square object-cover",ref_key:"canvasEl",ref:p},null,512))}}),ve={class:"flex aspect-square overflow-hidden rounded bg-black/25"},he=["textContent","title"],ye=z({__name:"DirEntry",props:{entry:null},setup(k){const r=k,p=y(""),_=y(!1),m=y(!1),c=y(null);te(c,([{isIntersecting:u}])=>{_.value=u,u&&!m.value&&(m.value=!0,r.entry.type==="image"?o(r.entry.file):b())});const o=u=>{p.value=URL.createObjectURL(u)},b=async()=>{if(!r.entry.isDir)return;const u=await ae(r.entry.handle),v=J(u,r.entry.displayName);if(v!=null&&v.isFile)return o(v.file);const h=re(u);if(h!=null&&h.isFile)return o(h.file)};se(()=>{p.value.startsWith("blob:")&&URL.revokeObjectURL(p.value)});const d=oe(),x=E(()=>{const{name:u}=r.entry.handle,{path:v}=d.params;return encodeURIComponent(v?decodeURIComponent(v)+"/"+u:u)}),f=le(),U=async()=>{if(r.entry.isDir){f.push({name:"Files",params:{path:x.value}});return}r.entry.isActive=!0},L=E(()=>{switch(r.entry.type){case"audio":return"Music1";case"dir":return"Folder";case"image":return"MediaImage";case"markdown":return"TextAlt";case"pdf":return"JournalPage";case"text":return"Page";case"unknown":return"EmptyPage";case"video":return"MediaVideo";default:return"EmptyPage"}});return(u,v)=>{const h=K("app-icon");return n(),i("button",{ref_key:"refWrap",ref:c,class:"group flex flex-col items-stretch gap-1 text-left",onClick:U},[a("div",ve,[m.value&&p.value?G((n(),S(fe,{key:0,src:p.value},null,8,["src"])),[[ne,_.value]]):(n(),S(h,{key:1,name:e(L),size:"48",class:"mx-auto self-center text-gray-700"},null,8,["name"]))]),a("div",{class:"truncate rounded bg-gray-800 p-2 text-sm leading-none text-gray-500 group-hover:bg-gray-700/50",textContent:T(k.entry.displayName),title:k.entry.handle.name},null,8,he)],512)}}}),_e={class:"sticky top-0"},be={class:"flex items-center justify-between bg-black/75 px-4 py-1 text-gray-400 backdrop-blur"},ke={class:"flex flex-wrap items-baseline gap-4"},we=["textContent"],Ce=["textContent"],Fe={class:"flex gap-2"},De={key:0,class:"animate-spin"},Re={key:0,class:"flex flex-wrap gap-2 bg-black/50 px-4 py-2 text-gray-400 backdrop-blur"},Te=["onClick","onContextmenu","textContent"],Ee=["textContent"],Ue={key:0,class:"grid grow place-content-center"},Le={key:0,class:"space-y-4 text-center text-gray-600"},Ie=a("div",{class:"text-xl font-medium uppercase"},"No Results",-1),$e={key:1,class:"space-y-2 text-center text-gray-600"},Ae=a("div",{class:"text-xl font-medium uppercase"},"Empty",-1),Me={key:0,class:"mx-auto w-full max-w-screen-2xl p-4"},je={class:"flex gap-4 rounded bg-gray-800 p-8 shadow-lg"},Se=["innerHTML"],ze={key:0},Ne=["src","alt"],Oe={class:"mx-auto grid w-full max-w-screen-2xl grid-cols-5 gap-4 p-4"},Pe=z({__name:"Dir",setup(k){ie();const{showFilter:r,resetFilter:p,toggleFilter:_,filteredDirEntries:m,stringFilter:c,getTagsFromString:o,isTagFilterActive:b,isTagInFilter:d,removeTagsFromString:x,resetTagFilter:f,tagFilterOptions:U,toggleTag:L,isUntaggedActive:u,toggleUntagged:v}=ce(A),h=y(),Q=async()=>{var s;_(),await pe(),(s=h.value)==null||s.focus()},I=y(""),N=y([]),$=new H.Renderer,X=$.link;$.link=(s,l,g)=>{const w=s==null?void 0:s.startsWith(`${location.protocol}//${location.hostname}`),D=X.call($,s,l,g);return w?D:D.replace(/^<a /,'<a target="_blank" rel="noreferrer noopener nofollow" ')},q(R,async s=>{if(!s){I.value="";return}const{content:l,frontmatter:{tags:g}={}}=await xe(s);I.value=H.parse(l,{headerIds:!1,renderer:$}),N.value=Array.isArray(g)?g.map(w=>String(w)):[]},{immediate:!0});const Y=E(()=>{var s;return[...new Set([...N.value,...o(((s=R.value)==null?void 0:s.name)||"")].sort())]}),O=E(()=>{var s;return J(A.value,x(((s=R.value)==null?void 0:s.name)||""))}),V=E(()=>{var s;return((s=O.value)==null?void 0:s.isFile)&&URL.createObjectURL(O.value.file)});return(s,l)=>{var w,D;const g=K("app-icon");return n(),i(M,null,[a("header",_e,[a("div",be,[a("div",ke,[a("span",{textContent:T(e(x)(((w=e(R))==null?void 0:w.name)||""))},null,8,we),a("span",{class:"text-sm text-slate-600",textContent:T(e(Y).join(", "))},null,8,Ce)]),a("div",Fe,[e(me)?(n(),i("div",De,[C(g,{class:"-scale-x-100",name:"AirplaneRotation"})])):F("",!0),e(r)?G((n(),i("input",{key:1,ref_key:"$stringFilter",ref:h,"onUpdate:modelValue":l[0]||(l[0]=t=>de(c)?c.value=t:null),class:"rounded-full border border-slate-600 bg-transparent px-4 outline-none placeholder:text-slate-700 focus:bg-slate-800 focus:placeholder:text-slate-400",type:"search",placeholder:"Filter listâ€¦"},null,512)),[[ue,e(c)]]):F("",!0),a("button",{onClick:Q,class:j(["p-1",{"text-amber-600":e(r)}])},[C(g,{name:"Filter"})],2),a("button",{class:"p-1",onClick:l[1]||(l[1]=(...t)=>e(P)&&e(P)(...t))},[C(g,{name:"Refresh"})]),a("button",{class:"p-1",onClick:l[2]||(l[2]=(...t)=>e(W)&&e(W)(...t))},[C(g,{name:"Folder"})])])]),e(r)&&e(U).length?(n(),i("div",Re,[(n(!0),i(M,null,B(e(U),t=>(n(),i("button",{key:t,class:j(["rounded-full px-2 text-sm",{"bg-amber-700 text-amber-100":e(d)(t,"include"),"bg-slate-900 text-slate-400 line-through":e(d)(t,"exclude"),"bg-slate-800 text-slate-400":!e(d)(t,"include")&&!e(d)(t,"exclude")}]),onClick:Z=>e(L)(t,"include"),onContextmenu:ge(Z=>e(L)(t,"exclude"),["prevent"]),textContent:T(t)},null,42,Te))),128)),a("button",{class:j(["rounded-full border px-2 text-sm",e(u)?"border-amber-700 text-amber-300":"border-slate-800 text-slate-600"]),onClick:l[3]||(l[3]=t=>e(v)()),textContent:T(e(b)?"+ Untagged":"Untagged")},null,10,Ee),e(b)||e(u)?(n(),i("button",{key:0,class:"text-sm text-slate-500",onClick:l[4]||(l[4]=(...t)=>e(f)&&e(f)(...t))}," clear ")):F("",!0)])):F("",!0)]),!e(A).length||!e(m).length?(n(),i("div",Ue,[!e(m).length&&e(A).length?(n(),i("div",Le,[C(g,{class:"mx-auto",name:"AreaSearch",size:"96"}),Ie,a("button",{class:"rounded-full border border-slate-600 px-4 py-1 font-medium",onClick:l[5]||(l[5]=(...t)=>e(p)&&e(p)(...t))}," Reset Filter ")])):(n(),i("div",$e,[C(g,{class:"mx-auto",name:"GlassEmpty",size:"96"}),Ae]))])):(n(),i(M,{key:1},[I.value?(n(),i("div",Me,[a("div",je,[a("div",{class:"prose prose-sm prose-invert max-w-none flex-grow prose-headings:text-teal-100 prose-a:text-teal-600 prose-pre:bg-black prose-img:rounded",innerHTML:I.value},null,8,Se),e(V)?(n(),i("div",ze,[a("img",{src:e(V),alt:(D=e(R))==null?void 0:D.name,class:"h-64 w-64 rounded object-cover shadow"},null,8,Ne)])):F("",!0)])])):F("",!0),a("div",Oe,[(n(!0),i(M,null,B(e(m),t=>(n(),S(ye,{key:t.handle.name,entry:t},null,8,["entry"]))),128))])],64))],64)}}});export{Pe as default};
